  {{template "header" .}}

<body>


  <div class="container-fluid">


    <div id="dataMapDetail">
      <div class="card">
        <div class="card-header">
          <strong>{{.Title}}&nbsp;:&nbsp;</strong>
          <code>{{.DataMapPageID}}</code>
          <div class="btn-group float-right">

            <button id="export" type="button" class="btn btn-outline-primary" onclick="saveFile()">
              <i class="fas fa-file-code" ></i>&nbsp;&nbsp;Export</button>

            <button id="close" type="button" class="btn btn-outline-secondary" onclick="history.back()">
              <i class="far fa-window-close" ></i>&nbsp;&nbsp;Cancel</button>

          </div>
        </div>

        <div class="card-body d-flex h-100 flex-column">

          <textarea class="form-control" name="pgContent" id="pgContent" rows="{{.JSRows}}" cols="80" disabled>{{.FullRecord}}</textarea>




        </div>



      </div>
    </div>
  </div>

</body>
<script>
  let saveFile = () => {

    // Get the data from each element on the form.
    const name = document.getElementById('pgContent');

    // This variable stores all the data.
    let data = '\r ' + name.value + ' \r\n '

    // Convert the text to BLOB.
    const textToBLOB = new Blob([data], {
      type: 'text/plain'
    });
    const sFileName = 'DatamapXML_{{.DataMapPageID}}.xml'; // The file to save the data.

    let newLink = document.createElement("a");
    newLink.download = sFileName;

    if (window.webkitURL != null) {
      newLink.href = window.webkitURL.createObjectURL(textToBLOB);
    } else {
      newLink.href = window.URL.createObjectURL(textToBLOB);
      newLink.style.display = "none";
      document.body.appendChild(newLink);
    }

    newLink.click();
  }
</script>
